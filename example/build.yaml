---
registry: repo.local
prefix: alpine
maintainer: Tomasz GÄ…gor <tomasz@gagor.pl>

images:
  base:
    dockerfile: base/Dockerfile.tpl
    variables:
      alpine:
        - "3.18"
        - "3.19"
        - "3.20"
    labels:
      - base:{{ .tag }}-alpine{{ .alpine }}
      - base:alpine{{ .alpine }}
      # - base:{{ .tag }}-alpine{{ index (split "." .alpine) 0 }}
      # - base:{{ .tag }}-alpine{{ .alpine | split "." | first }}
      # - base:alpine{{ index (split "." .alpine) 0 }}
      - base:{{ .tag }}-alpine
      - base:{{ .tag }}
      - base:alpine
      - base

  jdk:
    dockerfile: jdk/Dockerfile.tpl
    variables:
      alpine:
        - "3.19"
        - "3.20"
      java:
        - 11
        - 17
        - 21
        - 23
    excludes:
      - alpine: "3.19"
        java: 23
      - alpine: "3.20"
        java: 11
    labels:
      - jdk:{{ .tag }}-{{ .java }}-alpine{{ .alpine }}
      - jdk:{{ .java }}-alpine{{ .alpine }}
      # - jdk:{{ .java }}-alpine{{ index (split "." .alpine) 0 }}
      - jdk:{{ .tag }}-{{ .java }}-alpine
      - jdk:{{ .tag }}-{{ .java }}
      - jdk:{{ .java }}-alpine
      - jdk:{{ .tag }}
      - jdk

  jre:
    dockerfile: jre/Dockerfile.tpl
    variables:
      alpine:
        # - "3.19"
        - "3.20"
      java:
        - 11
        - 17
        - 21
        - 23
    excludes:
      - alpine: "3.20"
        java: 11
    labels:
      - jre:{{ .tag }}-{{ .java }}-alpine{{ .alpine }}
      - jre:{{ .java }}-alpine{{ .alpine }}
      # - jre:{{ .java }}-alpine{{ index (split "." .alpine) 0 }}
      - jre:{{ .tag }}-{{ .java }}-alpine
      - jre:{{ .tag }}-{{ .java }}
      - jre:{{ .java }}-alpine
      - jre:{{ .java }}
      - jre:{{ .tag }}
      - jre
